/**
 * Métadonnées statiques des 16 stratégies.
 * V1 : hardcodé. V2 : remplacé par GET /api/strategies/registry.
 */

const STRATEGY_FAMILIES = {
  scalp: { label: 'Scalp (5m)', color: '#4da6ff', order: 3 },
  swing: { label: 'Swing (1h)', color: '#ffc53d', order: 2 },
  grid:  { label: 'Grid / DCA (1h)', color: '#00e68a', order: 1 },
}

const STRATEGIES = [
  // ─── Grid / DCA (8) ───
  {
    id: 'grid_atr',
    name: 'Grid ATR',
    family: 'grid',
    timeframe: '1h',
    type: 'Mean Reversion',
    direction: 'Long + Short',
    status: 'live',
    hasGuide: true,
    shortDesc: 'Enveloppes adaptatives SMA ± ATR × multiplier. Achète les dips sous la SMA, revend au retour.',
    edge: "Profite des exagérations de prix par rapport à la moyenne. L'ATR rend la grille adaptative à la volatilité.",
    strengths: ['Excelle en crash + recovery', 'Grille auto-adaptative', 'Fonctionne sur 10+ assets'],
    weaknesses: ['Inactif en marché calme/range', 'Vulnérable aux tendances baissières prolongées'],
    keyParams: [
      { name: 'ma_period', default: 20, desc: 'Période SMA (moyenne mobile)' },
      { name: 'atr_period', default: 14, desc: "Période ATR (mesure de volatilité)" },
      { name: 'atr_multiplier_start', default: 2.0, desc: 'Multiplier ATR du 1er niveau' },
      { name: 'atr_multiplier_step', default: 1.0, desc: "Incrément par niveau supplémentaire" },
      { name: 'num_levels', default: 3, desc: 'Nombre de niveaux DCA' },
      { name: 'sl_percent', default: 20, desc: 'Stop Loss global (% du prix moyen)' },
    ],
    entryLogic: 'entry = SMA - ATR × (start + level × step). Un seul côté actif à la fois.',
    exitLogic: 'TP = prix revient à la SMA. SL = prix moyen ± sl_percent%.',
    wfoGrade: 'B',
  },
  {
    id: 'grid_boltrend',
    name: 'Grid BolTrend',
    family: 'grid',
    timeframe: '1h',
    type: 'Trend DCA',
    direction: 'Long + Short',
    status: 'paper',
    hasGuide: false,
    shortDesc: 'DCA event-driven activé sur breakout Bollinger filtré par tendance long terme.',
    edge: "Combine signal directionnel (breakout) avec exécution DCA. Active la grille uniquement sur signal fort.",
    strengths: ['Signal directionnel réduit les faux départs', 'Bon en trend + pullback'],
    weaknesses: ['Moins de trades que grid_atr', 'Warm-up long (400 bougies SMA)'],
    keyParams: [
      { name: 'bol_window', default: 100, desc: 'Période Bollinger' },
      { name: 'bol_std', default: 2.0, desc: 'Écart-type Bollinger' },
      { name: 'long_ma_window', default: 200, desc: 'SMA filtre tendance' },
      { name: 'atr_spacing_mult', default: 1.0, desc: 'Espacement niveaux (× ATR)' },
      { name: 'num_levels', default: 3, desc: 'Niveaux DCA' },
      { name: 'sl_percent', default: 15, desc: 'SL global (%)' },
    ],
    entryLogic: 'Breakout Bollinger (close franchit la bande) + filtre close > SMA longue. Level 0 = prix au breakout, Level k = breakout ± k × ATR.',
    exitLogic: 'TP inversé = close repasse sous/sur la SMA Bollinger. SL = % du prix moyen.',
    wfoGrade: 'B',
  },
  {
    id: 'envelope_dca',
    name: 'Envelope DCA',
    family: 'grid',
    timeframe: '1h',
    type: 'Mean Reversion',
    direction: 'Long only',
    status: 'replaced',
    hasGuide: false,
    shortDesc: "Ancêtre de grid_atr. Enveloppes à pourcentages fixes autour de la SMA (pas adaptatives).",
    edge: "Concept fondateur du DCA multi-niveaux. Remplacé par grid_atr qui adapte les niveaux à la volatilité.",
    strengths: ['Simple à comprendre', 'Premier Grade B obtenu'],
    weaknesses: ['Niveaux fixes ignorent la volatilité', 'Long-only uniquement'],
    keyParams: [
      { name: 'envelope_start', default: 0.05, desc: 'Offset du 1er niveau (5%)' },
      { name: 'envelope_step', default: 0.05, desc: 'Incrément par niveau (5%)' },
      { name: 'num_levels', default: 3, desc: 'Niveaux DCA' },
      { name: 'sl_percent', default: 20, desc: 'SL global (%)' },
    ],
    entryLogic: 'Level i : SMA × (1 - envelope_start - i × envelope_step). Asymétrie log-return appliquée pour les shorts.',
    exitLogic: 'TP = retour à la SMA. SL = % du prix moyen.',
    wfoGrade: 'B',
  },
  {
    id: 'envelope_dca_short',
    name: 'Envelope DCA Short',
    family: 'grid',
    timeframe: '1h',
    type: 'Mean Reversion',
    direction: 'Short only',
    status: 'disabled',
    hasGuide: false,
    shortDesc: 'Miroir SHORT de envelope_dca. Même code, direction inversée.',
    edge: 'Couverture des marchés baissiers pour compléter envelope_dca.',
    strengths: ['Réutilise 100% du code envelope_dca'],
    weaknesses: ['Non validé en WFO'],
    keyParams: [],
    entryLogic: 'Miroir de envelope_dca avec enveloppes au-dessus de la SMA.',
    exitLogic: 'TP = retour à la SMA. SL = % du prix moyen.',
    wfoGrade: null,
  },
  {
    id: 'grid_range_atr',
    name: 'Grid Range ATR',
    family: 'grid',
    timeframe: '1h',
    type: 'Range Trading',
    direction: 'Long + Short simultanés',
    status: 'disabled',
    hasGuide: false,
    shortDesc: 'LONG et SHORT simultanés avec TP/SL individuels par position. Les deux côtés actifs en même temps.',
    edge: 'Capture la volatilité dans les deux sens simultanément.',
    strengths: ['Bidirectionnel simultané', 'TP/SL par position (pas global)'],
    weaknesses: ['WFO non lancé', 'Risque de double perte si breakout violent'],
    keyParams: [
      { name: 'atr_spacing_mult', default: 0.3, desc: 'Espacement (× ATR)' },
      { name: 'num_levels', default: 2, desc: 'Niveaux par côté' },
      { name: 'sl_percent', default: 10, desc: 'SL individuel (%)' },
    ],
    entryLogic: 'LONG : SMA - (i+1) × ATR × spacing. SHORT : SMA + (i+1) × ATR × spacing. Les deux simultanés.',
    exitLogic: 'TP individuel = retour à la SMA. SL individuel = entry ± sl_percent%.',
    wfoGrade: null,
  },
  {
    id: 'grid_multi_tf',
    name: 'Grid Multi-TF',
    family: 'grid',
    timeframe: '1h + 4h',
    type: 'Trend + DCA',
    direction: 'Long + Short',
    status: 'disabled',
    hasGuide: false,
    shortDesc: 'Supertrend 4h filtre la direction, Grid ATR 1h exécute. Force-close au flip de tendance.',
    edge: 'Filtre directionnel multi-timeframe réduit les entrées contre-tendance.',
    strengths: ['Filtre 4h robuste', 'Force-close au flip = coupe les pertes'],
    weaknesses: ['WFO terminé mais pas encore forward-testé'],
    keyParams: [],
    entryLogic: 'ST 4h = UP → LONG seulement. ST 4h = DOWN → SHORT seulement. Niveaux = Grid ATR standard.',
    exitLogic: 'TP = SMA. SL = %. Force-close si Supertrend 4h flippe.',
    wfoGrade: null,
  },
  {
    id: 'grid_funding',
    name: 'Grid Funding',
    family: 'grid',
    timeframe: '1h',
    type: 'Funding Arbitrage',
    direction: 'Long only',
    status: 'disabled',
    hasGuide: false,
    shortDesc: 'DCA déclenché par funding rate négatif (= le marché paie les longs). TP quand le funding redevient positif.',
    edge: 'Exploite un signal fondamental (funding) plutôt que technique.',
    strengths: ['Signal fondamental', 'Accumule des funding payments positifs'],
    weaknesses: ['Long-only', 'Funding data moins fiable en backtest'],
    keyParams: [
      { name: 'funding_threshold_start', default: -0.0005, desc: 'Seuil funding 1er niveau' },
      { name: 'num_levels', default: 3, desc: 'Niveaux DCA' },
      { name: 'tp_mode', default: 'funding_or_sma', desc: 'Mode TP' },
    ],
    entryLogic: 'Funding rate < seuil → ouvre un niveau. Seuils croissants par niveau.',
    exitLogic: 'TP = funding redevient positif OU retour SMA. SL = % prix moyen.',
    wfoGrade: null,
  },
  {
    id: 'grid_trend',
    name: 'Grid Trend',
    family: 'grid',
    timeframe: '1h',
    type: 'Trend Following DCA',
    direction: 'Long + Short',
    status: 'disabled',
    hasGuide: false,
    shortDesc: 'EMA cross + ADX filtre tendance, trailing stop ATR, force-close au flip.',
    edge: 'Trend following classique renforcé par DCA.',
    strengths: ['Trailing stop limite les pertes'],
    weaknesses: ['Échoue en forward test bear market', 'ADX souvent trop lent'],
    keyParams: [],
    entryLogic: 'EMA cross + ADX > seuil → niveaux DCA dans la direction de la tendance.',
    exitLogic: 'Trailing stop ATR. Force-close au flip EMA. SL = % prix moyen.',
    wfoGrade: 'F',
  },

  // ─── Swing (4) ───
  {
    id: 'boltrend',
    name: 'BolTrend',
    family: 'swing',
    timeframe: '1h',
    type: 'Breakout',
    direction: 'Long + Short',
    status: 'disabled',
    hasGuide: false,
    shortDesc: 'Breakout Bollinger + filtre SMA. Version mono-position (avant grid_boltrend).',
    edge: 'Signal directionnel via Bollinger squeeze.',
    strengths: ['Signal clair', 'Bon concept de base'],
    weaknesses: ['Trop peu de trades → DSR 0.00 → Grade C max', 'Remplacé par grid_boltrend (DCA)'],
    keyParams: [],
    entryLogic: 'Close franchit la bande Bollinger + close > SMA longue.',
    exitLogic: 'TP = close repasse sous la SMA Bollinger. SL fixe.',
    wfoGrade: 'C',
  },
  {
    id: 'bollinger_mr',
    name: 'Bollinger MR',
    family: 'swing',
    timeframe: '1h',
    type: 'Mean Reversion',
    direction: 'Long + Short',
    status: 'disabled',
    hasGuide: false,
    shortDesc: 'Mean reversion sur les bandes de Bollinger. TP dynamique au croisement SMA.',
    edge: 'Concept simple de retour à la moyenne.',
    strengths: ['Intuitif'],
    weaknesses: ["Grade F en WFO", "Pas d'edge détecté"],
    keyParams: [],
    entryLogic: 'Close touche la bande Bollinger opposée à la tendance.',
    exitLogic: 'TP = croisement SMA dynamique. SL fixe.',
    wfoGrade: 'F',
  },
  {
    id: 'donchian_breakout',
    name: 'Donchian Breakout',
    family: 'swing',
    timeframe: '1h',
    type: 'Breakout',
    direction: 'Long + Short',
    status: 'disabled',
    hasGuide: false,
    shortDesc: 'Breakout du canal Donchian (plus haut/plus bas sur N périodes). TP/SL basés sur ATR.',
    edge: 'Capture les breakouts de range.',
    strengths: ['Classique et éprouvé en trad-fi'],
    weaknesses: ['Grade F en crypto', 'Trop de faux breakouts'],
    keyParams: [],
    entryLogic: 'Close > Donchian upper → LONG. Close < Donchian lower → SHORT.',
    exitLogic: "TP/SL = multiples d'ATR.",
    wfoGrade: 'F',
  },
  {
    id: 'supertrend',
    name: 'SuperTrend',
    family: 'swing',
    timeframe: '1h',
    type: 'Trend Following',
    direction: 'Long + Short',
    status: 'disabled',
    hasGuide: false,
    shortDesc: 'Indicateur SuperTrend ATR-based. Flip LONG/SHORT quand le trend change.',
    edge: 'Suit la tendance avec un trailing stop intégré.',
    strengths: ['Trailing stop naturel', 'Populaire et bien compris'],
    weaknesses: ['Grade F en crypto 1h', 'Whipsaws en range'],
    keyParams: [],
    entryLogic: 'SuperTrend flip UP → LONG. Flip DOWN → SHORT.',
    exitLogic: 'Flip inverse = exit + reverse.',
    wfoGrade: 'F',
  },

  // ─── Scalp (4) ───
  {
    id: 'vwap_rsi',
    name: 'VWAP + RSI',
    family: 'scalp',
    timeframe: '5m + 15m',
    type: 'Mean Reversion',
    direction: 'Long + Short',
    status: 'disabled',
    hasGuide: false,
    shortDesc: 'Mean reversion VWAP en 5m, filtré par tendance 15m pour éviter le contre-trend.',
    edge: 'VWAP = prix moyen pondéré par volume (institutionnel).',
    strengths: ['Signal fondé sur le volume'],
    weaknesses: ['Grade F', 'VWAP moins pertinent en crypto 24/7'],
    keyParams: [],
    entryLogic: 'Prix s\'écarte du VWAP + RSI extrême + confirmation 15m.',
    exitLogic: 'Retour au VWAP ou SL fixe.',
    wfoGrade: 'F',
  },
  {
    id: 'momentum',
    name: 'Momentum',
    family: 'scalp',
    timeframe: '5m + 15m',
    type: 'Breakout',
    direction: 'Long + Short',
    status: 'disabled',
    hasGuide: false,
    shortDesc: 'Breakout volume sur 5m avec filtre de tendance.',
    edge: 'Capture les mouvements brusques.',
    strengths: ['Rapide à déclencher'],
    weaknesses: ['Grade F', 'Fees mangent le edge sur petits mouvements'],
    keyParams: [],
    entryLogic: 'Volume spike + price breakout + confirmation tendance.',
    exitLogic: 'TP/SL fixes.',
    wfoGrade: 'F',
  },
  {
    id: 'funding',
    name: 'Funding Arb',
    family: 'scalp',
    timeframe: '15m',
    type: 'Funding Arbitrage',
    direction: 'Long + Short',
    status: 'disabled',
    hasGuide: false,
    shortDesc: 'Arbitrage de taux de funding extrêmes. Paper only (pas de backtest possible).',
    edge: 'Exploite les déséquilibres du marché des futures.',
    strengths: ['Signal fondamental'],
    weaknesses: ['Pas backtestable', 'Paper only'],
    keyParams: [],
    entryLogic: 'Funding rate extrême → position inverse.',
    exitLogic: 'Funding rate revient à la normale.',
    wfoGrade: null,
  },
  {
    id: 'liquidation',
    name: 'Liquidation Cascades',
    family: 'scalp',
    timeframe: '5m',
    type: 'Event-Driven',
    direction: 'Long + Short',
    status: 'disabled',
    hasGuide: false,
    shortDesc: 'Détecte les zones de liquidation via Open Interest. Paper only (pas de backtest possible).',
    edge: 'Anticipe les cascades de liquidation.',
    strengths: ['Signal OI original'],
    weaknesses: ['Pas backtestable', 'Paper only', 'Données OI limitées'],
    keyParams: [],
    entryLogic: 'OI spike + prix approche zone de liquidation.',
    exitLogic: 'Cascade terminée ou SL.',
    wfoGrade: null,
  },
]

export { STRATEGY_FAMILIES, STRATEGIES }
export default STRATEGIES
